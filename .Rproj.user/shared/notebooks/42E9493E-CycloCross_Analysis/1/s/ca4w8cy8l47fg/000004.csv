"0","smoothTrend <- lapply(cCross, function(x) {"
"0","  s <- loess(x[, 2] ~ seq(1:length(x[, 1])))"
"0","  smoothIndex <- predict(s)"
"0","  n <- names(x)"
"0","  p <- ggplot(data = x) +"
"0","    geom_line(aes_string(x = n[1], y = n[2])) +"
"0","    geom_line(aes(x = x[, 1], y = smoothIndex), colour = ""blue"") +"
"0","    ylab(""Google Search Index (100 = max point)"") + "
"0","    ggtitle(paste0(""Popularity of cyclo-cross related searches - "", n[2]))"
"0","  return(p)"
"0","})"
"0","seasonTrend <- lapply(cCross, function(x){"
"0","  s <- loess(x[, 2] ~ seq(1:length(x[, 1])))"
"0","  DF <- data.frame(trend = predict(s),"
"0","                         week = x[, 1])"
"0","  DF$Year <- as.numeric(format(DF$week, format = ""%Y""))"
"0","  DF$Month <- as.numeric(format(DF$week, format = ""%m""))"
"0","  DF$Season <- ifelse(DF$Month > 5, DF$Year,DF$Year-1)"
"0","  DF <- aggregate(x = DF$trend, by = list(Season = DF$Season),mean)"
"0","  DF$Change <- c(NA, "
"0","                 unlist(sapply(1:nrow(DF), function(i) (DF$x[i]/DF$x[i-1]-1)*100)))"
"0","  names(DF)[2] <- names(x)[2]"
"0","  n <- names(DF)"
"0","  trend <- ggplot(data = DF, aes_string(x = n[1], y = n[2])) +"
"0","    geom_col() +"
"0","    ylab(""Google Search Index (100 = max point)"") + "
"0","    ggtitle(paste0(""Trend of popularity of CX related searches - "", n[2]))"
"0","  change <- ggplot(data = DF, aes_string(x = n[1], y = n[3])) +"
"0","    geom_col() +"
"0","    ylab(""Google Search Index (100 = max point)"") + "
"0","    ggtitle(paste0(""Average popularity of CX related searches by season - "", n[2]))"
"0","  return(list(Trend = trend,"
"0","                    Change = change,"
"0","                    Table = DF))"
"0","})"
